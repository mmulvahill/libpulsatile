% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_joint.R
\name{fit_pulse_joint}
\alias{fit_pulse_joint}
\title{fit_pulse_joint}
\usage{
fit_pulse_joint(
  driver_data,
  response_data,
  driver_time = "time",
  driver_conc = "concentration",
  response_time = "time",
  response_conc = "concentration",
  spec,
  iters = 250000,
  thin = 50,
  burnin = as.integer(0.1 * iters),
  use_tibble = TRUE,
  verbose = FALSE
)
}
\arguments{
\item{driver_data}{A data frame containing driver hormone measurements with
columns for time and concentration. Can also be a \code{pulse_sim} object.}

\item{response_data}{A data frame containing response hormone measurements
with columns for time and concentration. Can also be a \code{pulse_sim} object.}

\item{driver_time}{A string. Name of the time variable in \code{driver_data}
(default: "time").}

\item{driver_conc}{A string. Name of the concentration variable in
\code{driver_data} (default: "concentration").}

\item{response_time}{A string. Name of the time variable in \code{response_data}
(default: "time").}

\item{response_conc}{A string. Name of the concentration variable in
\code{response_data} (default: "concentration").}

\item{spec}{An object of class \code{joint_spec}, created by
\code{joint_spec()}, specifying the priors, starting values, and proposal
variances to use for both hormones and their coupling.}

\item{iters}{Number of MCMC iterations (default: 250000).}

\item{thin}{Thinning interval - save every \code{thin}th sample (default: 50).}

\item{burnin}{Number of initial samples to discard as burn-in (default: 0.1 * iters).}

\item{use_tibble}{Return chains as tibble data frames for prettier printing
(default: TRUE). Requires tibble package.}

\item{verbose}{Print diagnostic output every 5000 iterations including
parameter estimates and acceptance rates (default: FALSE).}
}
\value{
An object of class \code{joint_fit}, a list containing:
  \item{model}{Model type ("joint")}
  \item{call}{The matched function call}
  \item{driver_chain}{MCMC chain for driver hormone parameters}
  \item{response_chain}{MCMC chain for response hormone parameters}
  \item{association_chain}{MCMC chain for coupling parameters (rho, nu)}
  \item{driver_pulse_chain}{MCMC chain for individual driver pulses}
  \item{response_pulse_chain}{MCMC chain for individual response pulses}
  \item{driver_data}{Original driver data}
  \item{response_data}{Original response data}
  \item{time_range}{Time range of observations}
  \item{options}{List of fitting options (time/conc column names, thinning, iterations)}
  \item{spec}{Model specification used for fitting}
}
\description{
Fits a joint Bayesian deconvolution model for two coupled pulsatile hormones
measured from a single subject. The driver hormone pulses influence the
intensity of response hormone pulse occurrence through a coupling kernel
parameterized by rho (coupling strength) and nu (temporal spread).
}
\details{
The joint model estimates:

\strong{Driver Hormone:}
\itemize{
  \item Mean pulse mass and width
  \item Baseline concentration and half-life
  \item Pulse-to-pulse SD of mass and width
  \item Number of pulses (varies by MCMC iteration)
  \item Individual pulse locations, masses, and widths
}

\strong{Response Hormone:}
\itemize{
  \item Same parameters as driver
  \item Pulse occurrence influenced by driver pulses
}

\strong{Coupling Parameters:}
\itemize{
  \item rho: Coupling strength (how much driver affects response)
  \item nu: Temporal spread of coupling effect (variance)
}

The coupling is modeled through an intensity function:
λ(t) = Σ_j [ρ / √(2πν)] × exp(-(t - τ_j)² / (2ν))
where τ_j are driver pulse locations.
}
\examples{
\dontrun{
# Simulate driver and response data
set.seed(123)
driver <- simulate_pulse(n_obs = 24, true_pulses = 12)
response <- simulate_pulse(n_obs = 24, true_pulses = 15)

# Create specification
joint_spec <- joint_spec(
  prior_log_rho_mean = 0.0,
  prior_log_nu_mean = 3.0
)

# Fit joint model
fit <- fit_pulse_joint(
  driver_data = driver,
  response_data = response,
  spec = joint_spec,
  iters = 10000,
  thin = 10,
  burnin = 5000,
  verbose = TRUE
)

# Examine coupling parameters
summary(fit$association_chain)
plot(fit$association_chain$rho, type = "l")
}
}
\keyword{joint}
\keyword{pulse}
